<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üêÅ mousse</title>
  <link rel="icon" type="image/png" href="/static/favicon.png" sizes="64x64">
  <link rel="shortcut icon" href="/static/favicon.ico">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600;700&family=DM+Sans:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="brand">
      <span class="brand-icon">üêÅ</span>
      <h1>mousse</h1>
    </div>
    <div class="stats" id="stats">
      <div class="stat incomplete active-tab" id="stat-idles" data-mode="idle">
        <span class="stat-icon">‚ö†Ô∏è</span>
        <span class="stat-label">Idles</span>
        <span class="stat-value">0/5</span>
      </div>
      <div class="stat incomplete" id="stat-paths" data-mode="path">
        <span class="stat-icon">‚ö†Ô∏è</span>
        <span class="stat-label">Paths</span>
        <span class="stat-value">0/20</span>
      </div>
      <div class="stat incomplete" id="stat-holds" data-mode="hold">
        <span class="stat-icon">‚ö†Ô∏è</span>
        <span class="stat-label">Holds</span>
        <span class="stat-value">0/20</span>
      </div>
      <div class="stat incomplete" id="stat-drags" data-mode="drag">
        <span class="stat-icon">‚ö†Ô∏è</span>
        <span class="stat-label">Drags</span>
        <span class="stat-value">0/20</span>
      </div>
      <div class="stat incomplete" id="stat-slide_drags" data-mode="slide_drag">
        <span class="stat-icon">‚ö†Ô∏è</span>
        <span class="stat-label">Slides</span>
        <span class="stat-value">0/15</span>
      </div>
      <div class="stat incomplete" id="stat-grids" data-mode="grid">
        <span class="stat-icon">‚ö†Ô∏è</span>
        <span class="stat-label">Grids</span>
        <span class="stat-value">0/30</span>
      </div>
      <div class="stat incomplete" id="stat-browses" data-mode="browse">
        <span class="stat-icon">‚ö†Ô∏è</span>
        <span class="stat-label">Browse</span>
        <span class="stat-value">0/20</span>
      </div>
      <div class="stat incomplete disabled" id="stat-det" data-mode="det">
        <span class="stat-icon">üîç</span>
        <span class="stat-label">DET</span>
        <span class="stat-value">0/0</span>
      </div>
      <div class="stat incomplete disabled" id="stat-cls" data-mode="cls">
        <span class="stat-icon">üè∑Ô∏è</span>
        <span class="stat-label">CLS</span>
        <span class="stat-value">0/0</span>
      </div>
    </div>
    <button class="btn manage-btn" id="btn-manage" title="Manage recordings">
      <span>&#9881;</span>
    </button>

    <!-- Manage popover -->
    <div class="manage-popover hidden" id="manage-popover">
      <div class="manage-header">Manage Recordings</div>
      <div class="manage-rows" id="manage-rows"></div>
      <div class="manage-footer">
        <button class="manage-row-delete manage-delete-all" id="btn-delete-all">Delete everything</button>
      </div>
    </div>
  </header>

  <!-- Controls -->
  <div class="controls">
    <div class="controls-left">
      <div class="tabs">
        <button class="tab active" data-mode="idle">Idle</button>
        <button class="tab" data-mode="path">Path</button>
        <button class="tab" data-mode="hold">Hold</button>
        <button class="tab" data-mode="drag">Drag</button>
        <button class="tab" data-mode="slide_drag">Slide</button>
        <button class="tab" data-mode="grid">Grid</button>
        <button class="tab" data-mode="browse">Browse</button>
        <button class="tab disabled" data-mode="det" disabled>DET</button>
        <button class="tab disabled" data-mode="cls" disabled>CLS</button>
      </div>

      <div class="separator"></div>

      <select id="viewport-select">
        <option value="1920x1080">1920 √ó 1080</option>
        <option value="1366x768">1366 √ó 768</option>
        <option value="1536x864">1536 √ó 864</option>
        <option value="1440x900">1440 √ó 900</option>
        <option value="1280x720" selected>1280 √ó 720</option>
      </select>

      <select id="direction-select" class="hidden">
        <option value="to_center_from_ul">UL ‚Üí Center (need 8)</option>
        <option value="to_center_from_ur">UR ‚Üí Center (need 5)</option>
        <option value="to_center_from_l">L ‚Üí Center (need 4)</option>
        <option value="to_center_from_bl">BL ‚Üí Center (need 3)</option>
        <option value="to_center_from_br">BR ‚Üí Center (need 3)</option>
        <option value="to_lower_from_ul">UL ‚Üí Lower (need 3)</option>
      </select>

      <span id="direction-info" class="direction-info hidden"></span>
    </div>

    <div class="controls-right">
      <button class="btn primary" id="btn-start">
        <span class="btn-text">Start</span>
        <kbd>Space</kbd>
      </button>
      <button class="btn accept hidden" id="btn-accept">
        <span class="btn-text">Accept</span>
        <kbd>Enter</kbd>
      </button>
      <button class="btn discard hidden" id="btn-discard">
        <span class="btn-text">Discard</span>
        <kbd>Esc</kbd>
      </button>
    </div>
  </div>

  <!-- Canvas -->
  <div class="canvas-wrap">
    <canvas id="canvas" width="1280" height="720"></canvas>

    <!-- DET annotation panel -->
    <div class="tool-panel hidden" id="det-panel">
      <div class="det-status">
        <div class="det-outcome" id="det-outcome"></div>
        <div class="det-instruction" id="det-instruction"></div>
        <select id="det-class-override" title="Override class if keyword is wrong"></select>
      </div>
      <div class="det-grid" id="det-grid"></div>
      <div class="tool-footer">
        <div class="tool-progress" id="det-progress"></div>
        <div class="tool-help">Click cells = ground truth (green) ¬∑ Enter = save ¬∑ Esc = skip</div>
      </div>
      <div class="label-stats" id="det-stats"></div>
    </div>

    <!-- CLS labeling panel -->
    <div class="tool-panel hidden" id="cls-panel">
      <div class="cls-tile-wrap">
        <img id="cls-tile-img" alt="" />
      </div>
      <div class="cls-keyword" id="cls-keyword-text"></div>
      <div class="cls-conf-wrap" id="cls-confidence-wrap"></div>
      <div class="cls-buttons" id="cls-buttons-wrap"></div>
      <div class="tool-footer">
        <div class="tool-progress" id="cls-progress"></div>
        <div class="tool-help">Enter = confirm ¬∑ S = skip ¬∑ D = delete</div>
      </div>
      <div class="cls-history-header">Recent</div>
      <div class="cls-history" id="cls-history"></div>
      <button class="cls-flush-btn hidden" id="cls-flush-btn"></button>
      <div class="label-stats" id="cls-stats"></div>
    </div>
  </div>

  <!-- Recordings panel -->
  <div class="recordings-panel">
    <div class="recordings-header">
      <h3>Recordings</h3>
    </div>
    <div class="recordings-grid" id="recordings-grid"></div>
    <div class="recordings-empty" id="recordings-empty">No recordings yet</div>
  </div>

  <!-- Countdown overlay (hidden) -->
  <div class="countdown hidden" id="countdown">
    <span id="countdown-num">3</span>
  </div>

  <!-- Preview modal (hidden) -->
  <div class="modal-overlay hidden" id="modal">
    <div class="modal">
      <h3 id="modal-title">Preview</h3>
      <canvas id="modal-canvas" width="600" height="400"></canvas>
      <button class="btn modal-close" id="modal-close">
        <span class="btn-text">Close</span>
        <kbd>Esc</kbd>
      </button>
    </div>
  </div>

  <script src="/static/recorder.js"></script>
</body>
</html>
